{{define "title"}}Share the message{{end}}

{{define "secure-link"}}

<div id="msg-link" class="card">
    <div class="card-header">
        <h2 class="card-title card-title-with-icon">
            <svg class="title-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Secure Link Generated
        </h2>
        <p class="card-description">Your {{if .IsFile}}file{{else}}secret message{{end}} has been encrypted. Share this link and PIN separately.</p>
    </div>

    {{if .IsFile}}
    <div class="file-info-box">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
        </svg>
        <div class="file-details">
            <span class="file-name">{{.FileName}}</span>
            <span class="file-size">{{formatSize .FileSize}}</span>
        </div>
    </div>
    {{end}}

    <div class="form-group">
        <label for="msg-text">Copy this link to access your secret {{if .IsFile}}file{{else}}content{{end}}</label>
        <textarea name="msg-link-text"
                  id="msg-text"
                  readonly>{{.URL}}</textarea>
    </div>

    <div class="form-row {{if .EmailEnabled}}three-cols{{else}}two-cols{{end}}">
        <button type="button"
                class="main-btn"
                id="copy-link-btn"
                onclick="
                    const btn = this;
                    const textarea = document.getElementById('msg-text');
                    navigator.clipboard.writeText(textarea.value).then(() => {
                        btn.innerHTML = `<svg class='btn-icon' width='16' height='16' viewBox='0 0 24 24' fill='none'><polyline points='20,6 9,17 4,12' stroke='currentColor' stroke-width='2'/></svg><span class='btn-text'>Copied!</span>`;
                        btn.style.background = 'var(--color-success)';
                        setTimeout(() => {
                            btn.innerHTML = `<svg class='btn-icon' width='16' height='16' viewBox='0 0 24 24' fill='none'><rect x='9' y='9' width='13' height='13' rx='2' ry='2' stroke='currentColor' stroke-width='2'/><path d='M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1' stroke='currentColor' stroke-width='2'/></svg><span class='btn-text'>Copy Link</span>`;
                            btn.style.background = '';
                        }, 2000);
                    }).catch(() => {
                        btn.innerHTML = `<svg class='btn-icon' width='16' height='16' viewBox='0 0 24 24' fill='none'><line x1='18' y1='6' x2='6' y2='18' stroke='currentColor' stroke-width='2'/><line x1='6' y1='6' x2='18' y2='18' stroke='currentColor' stroke-width='2'/></svg><span class='btn-text'>Error!</span>`;
                        btn.style.background = 'var(--color-error)';
                    });
                ">
            <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span class="btn-text">Copy Link</span>
        </button>
        {{if .EmailEnabled}}
        <button type="button"
                class="second-btn"
                hx-get="/email-popup?link={{.URL}}"
                hx-target="#popup"
                hx-swap="outerHTML">
            <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="btn-text">Send Email</span>
        </button>
        {{end}}
        <a class="second-btn" href="/">
            <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
            </svg>
            Create Another
        </a>
    </div>
</div>
{{end}}
